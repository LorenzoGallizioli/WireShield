## General Information

| Field     | Value                                                    |
|-----------|----------------------------------------------------------|
| Project   | WireShield – VPN Client with Integrated Antivirus        |
| Version   | 1.0                                                      |
| Author    | Davide Bonsembiante                                      |
| Date      | 15-04-2025                                               |

&nbsp;

## Test Case ID: [WS-TC-003] 
### Title: Statistical Analysis of False Positives and False Negatives

**Test Category:**  
False Positive/Negative Analysis

**Priority:**  
Medium

&nbsp;

## Objective  
Accurately measure the rate of false positives and false negatives generated by ClamAV on a known dataset through automated external tests to evaluate its accuracy.

&nbsp;

## Pre-conditions

- WireShield is correctly installed and configured  
- ClamAV is installed and active  
- Test dataset prepared (benign and malicious files with known labels)  
- `AntivirusManager` and `DownloadManager` services active and operational  

&nbsp;

## Test Environment

- Operating System: Windows 10  
- Java Version: OpenJDK 23  
- ClamAV Version: 1.4.2  
- Dependencies: JavaFX, ClamAV CLI, active local logger  

&nbsp;

## Test Data

Mixed dataset of:
- Benign files:
  - `sample3.ppt`
  - `sample4.docx`
  - `sample3.csv`
  - `sample_640×426.gif`
  - `sample_640×426.bmp`
  - `sample3.c`
- Malware files:
  - `eicar.com.blocked`
  - `eicar.com.txt.blocked`
  - `eicar_com.zip.blocked`

&nbsp;

## Execution Steps

1. **Dataset Preparation**:  
   Prepare a dataset containing a mix of known benign and malicious files. Each file must be correctly labeled as benign or malicious. Examples include:
   Mixed dataset of:
   - Benign files:
      - `sample3.ppt`
      - `sample4.docx`
      - `sample3.csv`
      - `sample_640×426.gif`
      - `sample_640×426.bmp`
      - `sample3.c`
   - Malware files:
      - `eicar.com.blocked`
      - `eicar.com.txt.blocked`
      - `eicar_com.zip.blocked`

2. **Scan Execution**:  
   Start scanning the files using WireShield, carefully observing the results for each file.

3. **Result Verification**:
   - Examine the scan results for each file:
     - **False Positives**: A file that is benign but is mistakenly detected as malware.
     - **False Negatives**: A file that is actually malware but is not detected by the system.
     - **Correct Detection**: The file is correctly identified as benign or malicious, as expected.

4. **Data Analysis**:
   After the scan, collect the following data:
   - **Number of files scanned**
   - **Number of malware correctly detected**
   - **Number of false positives**
   - **Number of false negatives**
   - **Percentages of false positives and false negatives relative to the total files scanned**

5. **Execution Verification**:
   - Ensure there are no exceptions or crashes during execution.
   - Results must be easily verifiable and repeatable.

&nbsp;

## Expected Results

- All benign files are correctly recognized as safe.  
- All files containing EICAR are detected and moved to quarantine.  
- No false positives detected.  
- No false negatives detected.  
- No crashes or abnormal behavior during the test.  

&nbsp;

## Actual Results

During the test execution, the following files were scanned:

- **Benign files** correctly recognized:
  - `sample3.ppt`
  - `sample4.docx`
  - `sample3.csv`
  - `sample_640×426.gif`
  - `sample_640×426.bmp`
  - `sample3.c`

- **Malware files** correctly identified and quarantined:
  - `eicar.com.blocked`
  - `eicar.com.txt.blocked`
  - `eicar_com.zip.blocked`

- **Collected Data**:
  - Total number of files scanned: **9**
  - Malware correctly detected: **3**
  - False positives: **0**
  - False negatives: **0**
  - Percentages:
    - False positives: **0%**
    - False negatives: **0%**

- No crashes or errors occurred during the entire execution.

**Analysis**:
- No **false negatives** were detected during the test. Every file that should have been detected as malware was correctly identified.  
- No **false positives** were detected; all benign files were correctly identified as safe.  

&nbsp;

## Status

**Passed**

&nbsp;

## Attachments and Collected Metrics

- **Video recording of the test session**, including:
  - Test execution
  - Antivirus status and WireShield behavior
  - Real-time metrics display:  
    - CPU usage  
    - Memory usage  
    - Disk I/O

https://github.com/user-attachments/assets/4bb5c45e-d80b-44cf-8168-86c97ce92152

